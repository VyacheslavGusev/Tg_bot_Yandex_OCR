# Tg_bot_OCR
Телеграм бот для распознования рукописных анкет.\
Модуль распознования текста - Yandex OCR.\
Бот принимает на вход PDF или изображение с отсканированными анкетами, далее в случае получения PDF, происходит его разделение на отдельные файлы изображения с помощью библиотеки Fitz.
После разделения файлов на изображения, с помощью инструментов Open CV выравниваем изображения по среднему углу прямых линий, так чтобы текст стал горизонтальным. Это облегчает дальнейший разбор распознанного текста по координатам и формирования итоговой таблицы с результатами.\
Рерзультат работы модуля распознования Yandex OCR представлен в формате структурированного JSON, который далее разбирается в список распознанных слов с координатаами.\
Далее из списка формируется список ключей с координатами, по сопоставлению с доступными полями анкет из списка feald_list. Сравнение происходит путем попарного сопоставления распознанных слов для поиска полного вхождения строки в строку ключа. Таким образом находятся только те поля анкеты, которые были в распозноваемом изображении.\
После формирования списка распознанных полей, определяются границы конца сегмента, в котором находится рукописный текст. Это необходимо для точного захвата только рукописного текста, поскольку на одной строке могут находиться два поля. Определение границы сегмента происходит путем сравнения координат X найденных ключей, находящихся на одной координате Y.
Когда ключи с координатами и границами сегментов поиска сформированы, ищем по вхождению в диапозоны распознанный рукописный текст и записываем его в результирующий датафрейм.\
На выход телеграм бот отдает файл Excel, готовый к валидации и экспорту в CRM систему.

